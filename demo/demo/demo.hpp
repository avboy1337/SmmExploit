#pragma once
#include <ntddk.h>
#include <ntstrsafe.h>
#include <ntintsafe.h>
#include <intrin.h>


#ifndef Add2Ptr
#define Add2Ptr(P,I) ((PVOID)((PUCHAR)(P) + (I)))
#endif

static const ULONG k_PoolTag = 'OMED';

#define DEMO_INFO(Format, ...) \
    DbgPrintEx(DPFLTR_IHVDRIVER_ID, \
               DPFLTR_ERROR_LEVEL, \
               "[+] %s: " Format "\n", \
               __FUNCTION__, \
               __VA_ARGS__)

#define DEMO_ERROR(Format, ...) \
    DbgPrintEx(DPFLTR_IHVDRIVER_ID, \
               DPFLTR_ERROR_LEVEL, \
               "[-] %s: " Format "\n", \
               __FUNCTION__, \
               __VA_ARGS__)
